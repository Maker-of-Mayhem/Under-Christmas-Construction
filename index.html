<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generator Solutions — Under Construction</title>
  <meta name="description" content="Generator Solutions — Scheduled Maintenance. Emergency services available during the holidays." />

  <style>
    :root{
      --bg0:#050a1b;
      --bg1:#071a44;
      --bg2:#0a2a66;
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --card: rgba(255,255,255,.07);
      --stroke: rgba(255,255,255,.14);
      --glow: rgba(120,220,255,.55);
      --warm: rgba(255,195,130,.35);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      background:
        radial-gradient(1100px 650px at 15% 10%, rgba(120,220,255,.16), transparent 60%),
        radial-gradient(900px 520px at 80% 18%, rgba(255,195,130,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 55%, var(--bg2));
      overflow-x:hidden;
    }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 34px 18px 44px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      margin-bottom: 14px;
    }

    .brand{
      display:inline-grid;
      gap:8px;
      justify-items:center;
    }
    .brand h1{
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing: .6px;
      margin:0;
      font-weight: 850;
      text-transform: uppercase;
    }
    .brand .sub{
      color: var(--muted);
      font-weight: 650;
      letter-spacing:.2px;
      font-size: 14px;
    }

    .panel{
      margin-top: 18px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border-radius: 22px;
      padding: 18px 18px 20px;
      box-shadow: 0 18px 65px rgba(0,0,0,.45);
      position: relative;
      overflow: hidden;
    }

    .scene-wrap{
      position: relative;
      width: 100%;
      height: 420px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 260px at 30% 20%, rgba(120,220,255,.13), transparent 60%),
        radial-gradient(600px 260px at 70% 10%, rgba(255,195,130,.10), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.10));
      overflow:hidden;
    }

    /* Scene fade layer for loop */
    #sceneFade{
      position:absolute;
      inset:0;
      background:#000;
      opacity:1;
      pointer-events:none;
      z-index: 50;
      transition: opacity 650ms ease;
    }

    /* Energy tree + glitter overlays */
    #energyTree{
      position:absolute;
      width:260px;
      height:420px;
      pointer-events:none;
      z-index: 3; /* behind generator */
      filter: drop-shadow(0 0 25px rgba(255,255,255,0.75));
      opacity: .98;
    }
    #glitterSwirl{
      position:absolute;
      width:360px;
      height:520px;
      pointer-events:none;
      z-index: 4; /* behind generator, above tree */
      opacity:.9;
      background-image: url("./assets/glitter-sprites-8x64.png");
      background-repeat: repeat;
      background-size: 512px 64px;
      mix-blend-mode: screen;
      filter: drop-shadow(0 0 16px rgba(255,255,255,0.35));
      animation: gsSprite 520ms steps(8) infinite, gsGlitterFloat 2.6s ease-in-out infinite;
    }

    /* Bow overlay */
    #genBow{
      position:absolute;
      width:160px;
      opacity:0;
      transform: translateX(-50%) scale(0.85);
      pointer-events:none;
      z-index: 10;
      filter: drop-shadow(0 0 22px rgba(255,0,0,0.65));
    }

    /* Footstep shadow */
    #techShadow{
      position:absolute;
      width:160px;
      height:44px;
      border-radius:50%;
      background: radial-gradient(closest-side, rgba(0,0,0,0.35), rgba(0,0,0,0));
      opacity:0;
      z-index: 2;
      filter: blur(2px);
      transform: translate(-50%,-50%);
      pointer-events:none;
    }

    /* Text block */
    .copy{
      margin-top: 18px;
      display:grid;
      gap: 10px;
      text-align:center;
      padding: 0 10px;
    }
    .copy .headline{
      font-size: 20px;
      font-weight: 850;
      margin-top: 6px;
    }
    .copy p{
      margin:0;
      color: var(--muted);
      line-height: 1.6;
      font-size: 15px;
    }
    .copy .contact{
      margin-top: 10px;
      font-weight: 800;
      color: rgba(255,255,255,.88);
      letter-spacing:.2px;
    }
    .copy a{ color: rgba(255,255,255,.92); }

    #xmasMessage{
      opacity:0;
      margin: 12px 0 2px;
      font-size: 1.35rem;
      font-weight: 850;
      color: #fff;
      text-shadow: 0 0 18px rgba(255,255,255,.35);
    }

    /* --- The SVG scene --- */
    svg{ width:100%; height:100%; display:block; }

    /* Tech group animation */
    .tech-group{
      transform: translateX(-260px);
      animation: techArrive 1.4s ease-out forwards;
      transform-origin: center;
    }

    /* Toolbox sits with tech, then gets picked up */
    .toolbox{
      opacity: 1;
      transform-origin:center;
    }

    /* Work motion (arms) */
    .arm{
      transform-origin: 50% 10%;
      animation: armWork 0.35s ease-in-out infinite;
    }

    /* Lid open/close */
    .lid{
      transform-origin: 72% 38%;
      animation: lidOpenClose 10s linear infinite;
    }

    /* Exit animation applied by JS */
    .exit{
      animation: techExit 2.6s ease-in forwards !important;
    }

    /* Pickup toolbox animation applied by JS */
    .pickup{
      animation: toolboxPickup 0.9s ease forwards !important;
    }

    @keyframes techArrive{
      to{ transform: translateX(0px); }
    }
    @keyframes armWork{
      0%,100%{ transform: rotate(-6deg); }
      50%{ transform: rotate(10deg); }
    }
    /* Lid cycles with the loop, but we also use JS timing for realism */
    @keyframes lidOpenClose{
      0%   { transform: rotate(-10deg); }
      10%  { transform: rotate(-10deg); }
      20%  { transform: rotate(0deg); }
      100% { transform: rotate(0deg); }
    }
    @keyframes toolboxPickup{
      to{
        transform: translateX(40px) translateY(-20px) scale(0.8);
        opacity:0;
      }
    }
    @keyframes techExit{
      to{
        transform: translateX(440px);
        opacity:0;
      }
    }
    @keyframes gsSprite{
      from{ background-position: 0 0; }
      to  { background-position: -512px 0; }
    }
    @keyframes gsGlitterFloat{
      0%{ transform: translate(0,0) rotate(0deg); opacity:.72; }
      50%{ transform: translate(-10px,-14px) rotate(3deg); opacity:.95; }
      100%{ transform: translate(0,0) rotate(0deg); opacity:.72; }
    }
    @keyframes fadeIn{
      to{ opacity:1; }
    }

    @media (max-width: 820px){
      .scene-wrap{ height: 360px; }
      #energyTree{ width: 220px; height: 360px; }
      #glitterSwirl{ width: 320px; height: 460px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>Generator Solutions</h1>
        <div class="sub">Scheduled Maintenance · Powering Confidence. Delivering Excellence.</div>
      </div>
    </header>

    <section class="panel">
      <div class="scene-wrap" id="scene">
        <!-- overlays -->
        <div id="sceneFade"></div>
        <canvas id="energyTree"></canvas>
        <div id="glitterSwirl"></div>
        <img id="genBow" src="./assets/gs-bow-glitter.png" alt="">
        <div id="techShadow"></div>

        <!-- SCENE SVG -->
        <svg viewBox="0 0 1100 420" aria-label="Under construction animation">
          <!-- ground -->
          <ellipse cx="560" cy="365" rx="520" ry="90" fill="rgba(0,0,0,.22)"/>
          <ellipse cx="560" cy="372" rx="500" ry="80" fill="rgba(0,0,0,.18)"/>

          <!-- generator group -->
          <g id="generator" transform="translate(585,155)">
            <!-- base shadow -->
            <ellipse cx="130" cy="205" rx="170" ry="26" fill="rgba(0,0,0,.33)"/>
            <!-- body -->
            <rect x="0" y="40" width="320" height="190" rx="18" fill="rgba(255,255,255,.12)" stroke="rgba(255,255,255,.16)"/>
            <rect x="16" y="58" width="288" height="154" rx="14" fill="rgba(0,0,0,.18)" stroke="rgba(255,255,255,.12)"/>

            <!-- vent -->
            <g opacity=".75">
              <rect x="34" y="86" width="90" height="8" rx="4" fill="rgba(255,255,255,.18)"/>
              <rect x="34" y="104" width="90" height="8" rx="4" fill="rgba(255,255,255,.18)"/>
              <rect x="34" y="122" width="90" height="8" rx="4" fill="rgba(255,255,255,.18)"/>
              <rect x="34" y="140" width="90" height="8" rx="4" fill="rgba(255,255,255,.18)"/>
            </g>

            <!-- control panel -->
            <rect x="150" y="84" width="140" height="96" rx="10" fill="rgba(255,255,255,.10)" stroke="rgba(255,255,255,.12)"/>
            <circle cx="175" cy="115" r="7" fill="rgba(120,220,255,.75)"/>
            <circle cx="200" cy="115" r="7" fill="rgba(255,195,130,.75)"/>
            <rect x="170" y="140" width="105" height="22" rx="8" fill="rgba(0,0,0,.22)"/>

            <!-- lid -->
            <g class="lid">
              <path d="M6,48 C40,8 285,8 314,48 L314,52 L6,52 Z" fill="rgba(255,255,255,.14)" stroke="rgba(255,255,255,.18)"/>
            </g>
          </g>

          <!-- TECH + toolbox -->
          <g class="tech-group" id="tech" transform="translate(250,215)">
            <!-- legs -->
            <rect x="28" y="118" width="18" height="58" rx="8" fill="rgba(255,255,255,.16)"/>
            <rect x="58" y="118" width="18" height="58" rx="8" fill="rgba(255,255,255,.16)"/>
            <!-- body -->
            <rect x="20" y="40" width="70" height="86" rx="16" fill="rgba(255,255,255,.14)" stroke="rgba(255,255,255,.12)"/>
            <!-- head -->
            <circle cx="55" cy="22" r="18" fill="rgba(255,255,255,.16)" stroke="rgba(255,255,255,.12)"/>
            <!-- arm -->
            <g class="arm">
              <rect x="82" y="55" width="52" height="16" rx="8" fill="rgba(255,255,255,.14)"/>
              <circle cx="134" cy="63" r="8" fill="rgba(255,255,255,.16)"/>
            </g>
            <!-- other arm -->
            <rect x="0" y="55" width="44" height="16" rx="8" fill="rgba(255,255,255,.12)"/>

            <!-- toolbox -->
            <g class="toolbox" id="toolbox" transform="translate(5,140)">
              <rect x="0" y="0" width="60" height="34" rx="8" fill="rgba(255,255,255,.14)" stroke="rgba(255,255,255,.12)"/>
              <rect x="10" y="-10" width="40" height="16" rx="8" fill="rgba(255,255,255,.12)"/>
              <rect x="10" y="12" width="40" height="6" rx="3" fill="rgba(0,0,0,.22)"/>
            </g>
          </g>
        </svg>
      </div>

      <div class="copy">
        <div class="headline">Our website is currently undergoing a full tune-up.</div>
        <p>
          Just like your generator, we’re performing scheduled maintenance to ensure everything runs smoothly,
          efficiently, and reliably when you need it most.
        </p>

        <div id="xmasMessage">Merry Christmas from all of us to you and yours</div>

        <p>Emergency Services available during the holidays.</p>

        <div class="contact">
          (705) 286-1003 ·
          <a href="mailto:sales@generatorsolutions.ca">sales@generatorsolutions.ca</a> ·
          <a href="https://www.generatorsolutions.ca" target="_blank" rel="noopener">www.generatorsolutions.ca</a>
        </div>
      </div>
    </section>
  </div>

  <script>
  (() => {
    // ===== CONFIG =====
    const LOOP_MS = 10000;

    const WORK_MS     = 5000;  // tech works
    const PICKUP_MS   = 900;   // toolbox pickup
    const EXIT_MS     = 2600;  // exit duration
    const BOW_AT_MS   = 8200;  // bow appears (+ chime)
    const MERRY_AT_MS = 8600;  // merry fades in
    const FADE_IN_MS  = 650;
    const FADE_OUT_MS = 700;

    // Elements
    const scene = document.getElementById("scene");
    const fade  = document.getElementById("sceneFade");
    const tech  = document.getElementById("tech");
    const box   = document.getElementById("toolbox");
    const gen   = document.getElementById("generator");
    const bow   = document.getElementById("genBow");
    const merry = document.getElementById("xmasMessage");
    const shadow= document.getElementById("techShadow");

    // ===== Place energy tree BESIDE + slightly behind right side of generator =====
    const treeCanvas = document.getElementById("energyTree");
    const glitterDiv = document.getElementById("glitterSwirl");

    function placeTree() {
      const genRect = gen.getBoundingClientRect();
      const sceneRect = scene.getBoundingClientRect();

      // Position tree slightly behind + to the right of generator
      const left = (genRect.left - sceneRect.left) + genRect.width - 35;  // just to the right
      const top  = (genRect.top  - sceneRect.top)  - 30;                 // slightly up
      treeCanvas.style.left = `${left}px`;
      treeCanvas.style.top  = `${top}px`;

      glitterDiv.style.left = `${left - 60}px`;
      glitterDiv.style.top  = `${top - 40}px`;

      // Bow centered on generator top
      bow.style.left = `${(genRect.left - sceneRect.left) + genRect.width * 0.50}px`;
      bow.style.top  = `${(genRect.top  - sceneRect.top)  + 22}px`;
    }

    window.addEventListener("resize", placeTree);
    setTimeout(placeTree, 50);

    // ===== Energy Tree Particles =====
    const ctx = treeCanvas.getContext("2d");
    function setupCanvas() {
      const w = treeCanvas.clientWidth || 260;
      const h = treeCanvas.clientHeight || 420;
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      treeCanvas.width = Math.floor(w * dpr);
      treeCanvas.height = Math.floor(h * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      return { w, h };
    }

    let dims = setupCanvas();
    window.addEventListener("resize", () => { dims = setupCanvas(); });

    const particles = [];
    const COUNT = 520;

    class Particle{
      constructor(w,h,initial=true){
        this.w=w; this.h=h;
        this.reset(initial);
      }
      reset(initial){
        this.angle = Math.random()*Math.PI*2;
        this.y = initial ? Math.random()*this.h : this.h + Math.random()*40;
        this.speed = 0.55 + Math.random()*0.85;
        this.size = 0.8 + Math.random()*2.2;
        this.alpha = 0.25 + Math.random()*0.75;
        this.tw = 0.008 + Math.random()*0.02;
      }
      update(t){
        const phase = (t % LOOP_MS) / LOOP_MS;
        const goingUp = phase < 0.62;
        this.y += goingUp ? -this.speed : (this.speed*0.55);
        this.angle += 0.020 + (1 - this.y/this.h)*0.012;
        this.alpha += Math.sin(t*this.tw)*0.003;
        if (this.y < -20) this.y = this.h + 30;
        if (this.y > this.h + 40) this.y = -10;
      }
      draw(){
        const coneWidth = (this.y/this.h) * (this.w*0.46);
        const x = (this.w/2) + Math.cos(this.angle)*coneWidth;

        const topBoost = Math.max(0, 1 - (this.y/120));
        const a = Math.min(1, Math.max(0.08, this.alpha + topBoost*0.35));

        ctx.fillStyle = `rgba(255,255,255,${a})`;
        ctx.beginPath();
        ctx.arc(x, this.y, this.size, 0, Math.PI*2);
        ctx.fill();
      }
    }

    function seedParticles(){
      particles.length = 0;
      for(let i=0;i<COUNT;i++) particles.push(new Particle(dims.w, dims.h, true));
    }
    seedParticles();

    function drawTopStar(w){
      const cx=w/2, cy=24;
      ctx.save();
      ctx.globalAlpha=0.9;
      for(let i=0;i<8;i++){
        const ang=i*Math.PI/4;
        ctx.strokeStyle="rgba(255,255,255,0.55)";
        ctx.lineWidth=2;
        ctx.beginPath();
        ctx.moveTo(cx+Math.cos(ang)*2, cy+Math.sin(ang)*2);
        ctx.lineTo(cx+Math.cos(ang)*18, cy+Math.sin(ang)*18);
        ctx.stroke();
      }
      ctx.fillStyle="rgba(255,255,255,0.9)";
      ctx.beginPath();
      ctx.arc(cx, cy, 6, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }

    let raf = null;
    let start = performance.now();

    function tick(now){
      const t = now - start;
      ctx.clearRect(0,0,dims.w,dims.h);
      ctx.fillStyle="rgba(255,255,255,0.03)";
      ctx.fillRect(0,0,dims.w,dims.h);

      for(const p of particles){ p.w=dims.w; p.h=dims.h; p.update(t); p.draw(); }
      drawTopStar(dims.w);

      raf = requestAnimationFrame(tick);
    }
    raf = requestAnimationFrame(tick);

    // ===== Bell/Glass Chime (synth) =====
    function playChime(){
      try{
        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        if(!AudioCtx) return;
        const a = new AudioCtx();
        const now = a.currentTime;
        const master = a.createGain();
        master.gain.setValueAtTime(0.0001, now);
        master.gain.exponentialRampToValueAtTime(0.18, now+0.01);
        master.gain.exponentialRampToValueAtTime(0.0001, now+1.2);
        master.connect(a.destination);

        function tone(freq, t0, dur, detune=0){
          const o=a.createOscillator();
          const g=a.createGain();
          const f=a.createBiquadFilter();
          o.type="sine";
          o.frequency.setValueAtTime(freq,t0);
          o.detune.setValueAtTime(detune,t0);

          f.type="highpass";
          f.frequency.setValueAtTime(600,t0);

          g.gain.setValueAtTime(0.0001,t0);
          g.gain.exponentialRampToValueAtTime(0.8,t0+0.01);
          g.gain.exponentialRampToValueAtTime(0.0001,t0+dur);

          o.connect(f); f.connect(g); g.connect(master);
          o.start(t0); o.stop(t0+dur+0.05);
        }

        tone(880, now, 0.65);
        tone(1320, now+0.02, 0.55, -6);
        tone(1760, now+0.04, 0.45, +4);

        setTimeout(()=>a.close && a.close(), 1500);
      }catch(e){}
    }

    // ===== Shadow tracker under tech during exit =====
    let shadowTracking = false;
    function startShadowTrack(){
      shadowTracking = true;
      shadow.style.opacity = "0.28";
      const loop = () => {
        if(!shadowTracking) return;
        const techRect = tech.getBoundingClientRect();
        const sceneRect= scene.getBoundingClientRect();
        const x = (techRect.left + techRect.width*0.55) - sceneRect.left;
        const y = (techRect.top  + techRect.height*0.92) - sceneRect.top;
        shadow.style.left = `${x}px`;
        shadow.style.top  = `${y}px`;
        requestAnimationFrame(loop);
      };
      requestAnimationFrame(loop);

      // fade out while exiting
      shadow.animate(
        [
          { opacity: 0.28, transform:"translate(-50%,-50%) scale(1)" },
          { opacity: 0.00, transform:"translate(-50%,-50%) scale(0.7)" }
        ],
        { duration: EXIT_MS, fill:"forwards", easing:"ease" }
      );
    }
    function stopShadowTrack(){ shadowTracking = false; shadow.style.opacity="0"; }

    // ===== Loop sequencing =====
    async function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }

    async function runLoop(){
      // Reset visuals
      merry.style.opacity = "0";
      bow.style.opacity = "0";
      bow.style.transform = "translateX(-50%) scale(0.85)";
      box.classList.remove("pickup");
      tech.classList.remove("exit");
      tech.style.opacity = "";
      tech.style.transform = "";
      box.style.opacity = "";
      box.style.transform = "";

      // Place overlays correctly
      placeTree();

      // Fade in at start
      fade.style.transition = `opacity ${FADE_IN_MS}ms ease`;
      fade.style.opacity = "1";
      await sleep(50);
      requestAnimationFrame(()=> fade.style.opacity = "0");

      // Work for 5 seconds (arms always working)
      await sleep(WORK_MS);

      // Toolbox pickup
      box.classList.add("pickup");
      await sleep(PICKUP_MS);

      // Tech exits + shadow fade
      startShadowTrack();
      tech.classList.add("exit");
      await sleep(EXIT_MS);
      stopShadowTrack();

      // Bow appears (+ chime)
      const elapsed = WORK_MS + PICKUP_MS + EXIT_MS;
      const waitToBow = Math.max(0, BOW_AT_MS - elapsed);
      await sleep(waitToBow);

      bow.style.transition = "opacity 450ms ease, transform 650ms ease";
      bow.style.opacity = "1";
      bow.style.transform = "translateX(-50%) scale(1)";
      playChime();

      // Merry fades in
      await sleep(Math.max(0, MERRY_AT_MS - BOW_AT_MS));
      merry.style.animation = "fadeIn 1.7s ease forwards";

      // Fade out at end, then reset
      const fadeOutAt = LOOP_MS - FADE_OUT_MS;
      await sleep(Math.max(0, fadeOutAt - MERRY_AT_MS));
      fade.style.transition = `opacity ${FADE_OUT_MS}ms ease`;
      fade.style.opacity = "1";
      await sleep(FADE_OUT_MS);

      // Restart loop cleanly
      merry.style.animation = "none";
      start = performance.now(); // keep tree feeling fresh each loop
      runLoop();
    }

    runLoop();
  })();
  </script>
</body>
</html>
